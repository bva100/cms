!function($){var Radio=function(element,options){this.init(element,options)};Radio.prototype={constructor:Radio,init:function(element,options){var $el=this.$element=$(element);this.options=$.extend({},$.fn.radio.defaults,options);$el.before(this.options.template);this.setState()},setState:function(){var $el=this.$element,$parent=$el.closest(".radio");$el.prop("disabled")&&$parent.addClass("disabled");$el.prop("checked")&&$parent.addClass("checked")},toggle:function(){var d="disabled",ch="checked",$el=this.$element,checked=$el.prop(ch),$parent=$el.closest(".radio"),$parentWrap=$el.closest("form").length?$el.closest("form"):$el.closest("body"),$elemGroup=$parentWrap.find(':radio[name="'+$el.attr("name")+'"]'),e=$.Event("toggle");$elemGroup.not($el).each(function(){var $el=$(this),$parent=$(this).closest(".radio");if($el.prop(d)==false){$parent.removeClass(ch)&&$el.attr(ch,false).trigger("change")}});if($el.prop(d)==false){if(checked==false)$parent.addClass(ch)&&$el.attr(ch,true);$el.trigger(e);if(checked!==$el.prop(ch)){$el.trigger("change")}}},setCheck:function(option){var ch="checked",$el=this.$element,$parent=$el.closest(".radio"),checkAction=option=="check"?true:false,checked=$el.prop(ch),$parentWrap=$el.closest("form").length?$el.closest("form"):$el.closest("body"),$elemGroup=$parentWrap.find(':radio[name="'+$el["attr"]("name")+'"]'),e=$.Event(option);$elemGroup.not($el).each(function(){var $el=$(this),$parent=$(this).closest(".radio");$parent.removeClass(ch)&&$el.removeAttr(ch)});$parent[checkAction?"addClass":"removeClass"](ch)&&checkAction?$el.attr(ch,true):$el.removeAttr(ch);$el.trigger(e);if(checked!==$el.prop(ch)){$el.trigger("change")}}};var old=$.fn.radio;$.fn.radio=function(option){return this.each(function(){var $this=$(this),data=$this.data("radio"),options=$.extend({},$.fn.radio.defaults,$this.data(),typeof option=="object"&&option);if(!data)$this.data("radio",data=new Radio(this,options));if(option=="toggle")data.toggle();if(option=="check"||option=="uncheck")data.setCheck(option);else if(option)data.setState()})};$.fn.radio.defaults={template:'<span class="icons"><span class="first-icon fui-radio-unchecked"></span><span class="second-icon fui-radio-checked"></span></span>'};$.fn.radio.noConflict=function(){$.fn.radio=old;return this};$(document).on("click.radio.data-api","[data-toggle^=radio], .radio",function(e){var $radio=$(e.target);if(e.target.tagName!="A"){e&&e.preventDefault()&&e.stopPropagation();if(!$radio.hasClass("radio"))$radio=$radio.closest(".radio");$radio.find(":radio").radio("toggle")}});$(window).on("load",function(){$('[data-toggle="radio"]').each(function(){var $radio=$(this);$radio.radio()})})}(window.jQuery);
!function($){var Selectpicker=function(element,options,e){if(e){e.stopPropagation();e.preventDefault()}this.$element=$(element);this.$newElement=null;this.button=null;this.options=$.extend({},$.fn.selectpicker.defaults,this.$element.data(),typeof options=="object"&&options);if(this.options.title==null)this.options.title=this.$element.attr("title");this.val=Selectpicker.prototype.val;this.render=Selectpicker.prototype.render;this.init()};Selectpicker.prototype={constructor:Selectpicker,init:function(e){var _this=this;this.$element.hide();this.multiple=this.$element.prop("multiple");var classList=this.$element.attr("class")!==undefined?this.$element.attr("class").split(/\s+/):"";var id=this.$element.attr("id");this.$element.after(this.createView());this.$newElement=this.$element.next(".select");var select=this.$newElement;var menu=this.$newElement.find(".dropdown-menu");var menuArrow=this.$newElement.find(".dropdown-arrow");var menuA=menu.find("li > a");var liHeight=select.addClass("open").find(".dropdown-menu li > a").outerHeight();select.removeClass("open");var divHeight=menu.find("li .divider").outerHeight(true);var selectOffset_top=this.$newElement.offset().top;var size=0;var menuHeight=0;var selectHeight=this.$newElement.outerHeight();this.button=this.$newElement.find("> button");if(id!==undefined){this.button.attr("id",id);$('label[for="'+id+'"]').click(function(){select.find("button#"+id).focus()})}for(var i=0;i<classList.length;i++){if(classList[i]!="selectpicker"){this.$newElement.addClass(classList[i])}}if(this.multiple){this.$newElement.addClass("select-multiple")}this.button.addClass(this.options.style);menu.addClass(this.options.menuStyle);menuArrow.addClass(function(){if(_this.options.menuStyle){return _this.options.menuStyle.replace("dropdown-","dropdown-arrow-")}});this.checkDisabled();this.checkTabIndex();this.clickListener();var menuPadding=parseInt(menu.css("padding-top"))+parseInt(menu.css("padding-bottom"))+parseInt(menu.css("border-top-width"))+parseInt(menu.css("border-bottom-width"));if(this.options.size=="auto"){function getSize(){var selectOffset_top_scroll=selectOffset_top-$(window).scrollTop();var windowHeight=window.innerHeight;var menuExtras=menuPadding+parseInt(menu.css("margin-top"))+parseInt(menu.css("margin-bottom"))+2;var selectOffset_bot=windowHeight-selectOffset_top_scroll-selectHeight-menuExtras;menuHeight=selectOffset_bot;if(select.hasClass("dropup")){menuHeight=selectOffset_top_scroll-menuExtras}menu.css({"max-height":menuHeight+"px","overflow-y":"auto","min-height":liHeight*3+"px"})}getSize();$(window).resize(getSize);$(window).scroll(getSize);this.$element.bind("DOMNodeInserted",getSize)}else if(this.options.size&&this.options.size!="auto"&&menu.find("li").length>this.options.size){var optIndex=menu.find("li > *").filter(":not(.divider)").slice(0,this.options.size).last().parent().index();var divLength=menu.find("li").slice(0,optIndex+1).find(".divider").length;menuHeight=liHeight*this.options.size+divLength*divHeight+menuPadding;menu.css({"max-height":menuHeight+"px","overflow-y":"scroll"})}this.$element.bind("DOMNodeInserted",$.proxy(this.reloadLi,this));this.render()},createDropdown:function(){var drop="<div class='btn-group select'>"+"<i class='dropdown-arrow'></i>"+"<button class='btn dropdown-toggle clearfix' data-toggle='dropdown'>"+"<span class='filter-option pull-left'></span>&nbsp;"+"<span class='caret'></span>"+"</button>"+"<ul class='dropdown-menu' role='menu'>"+"</ul>"+"</div>";return $(drop)},createView:function(){var $drop=this.createDropdown();var $li=this.createLi();$drop.find("ul").append($li);return $drop},reloadLi:function(){this.destroyLi();$li=this.createLi();this.$newElement.find("ul").append($li);this.render()},destroyLi:function(){this.$newElement.find("li").remove()},createLi:function(){var _this=this;var _li=[];var _liA=[];var _liHtml="";this.$element.find("option").each(function(){_li.push($(this).text())});this.$element.find("option").each(function(index){var optionClass=$(this).attr("class")!==undefined?$(this).attr("class"):"";var text=$(this).text();var subtext=$(this).data("subtext")!==undefined?'<small class="muted">'+$(this).data("subtext")+"</small>":"";text+=subtext;if($(this).parent().is("optgroup")&&$(this).data("divider")!=true){if($(this).index()==0){var label=$(this).parent().attr("label");var labelSubtext=$(this).parent().data("subtext")!==undefined?'<small class="muted">'+$(this).parent().data("subtext")+"</small>":"";label+=labelSubtext;if($(this)[0].index!=0){_liA.push('<div class="divider"></div>'+"<dt>"+label+"</dt>"+_this.createA(text,"opt "+optionClass))}else{_liA.push("<dt>"+label+"</dt>"+_this.createA(text,"opt "+optionClass))}}else{_liA.push(_this.createA(text,"opt "+optionClass))}}else if($(this).data("divider")==true){_liA.push('<div class="divider"></div>')}else{_liA.push(_this.createA(text,optionClass))}});if(_li.length>0){for(var i=0;i<_li.length;i++){var $option=this.$element.find("option").eq(i);_liHtml+="<li rel="+i+">"+_liA[i]+"</li>"}}if(this.$element.find("option:selected").length==0&&!_this.options.title){this.$element.find("option").eq(0).prop("selected",true).attr("selected","selected")}return $(_liHtml)},createA:function(test,classes){return'<a tabindex="-1" href="#" class="'+classes+'">'+'<span class="pull-left">'+test+"</span>"+"</a>"},render:function(){var _this=this;if(this.options.width=="auto"){var ulWidth=this.$newElement.find(".dropdown-menu").css("width");this.$newElement.css("width",ulWidth)}else if(this.options.width&&this.options.width!="auto"){this.$newElement.css("width",this.options.width)}this.$element.find("option").each(function(index){_this.setDisabled(index,$(this).is(":disabled")||$(this).parent().is(":disabled"));_this.setSelected(index,$(this).is(":selected"))});var selectedItems=this.$element.find("option:selected").map(function(index,value){if($(this).attr("title")!=undefined){return $(this).attr("title")}else{return $(this).text()}}).toArray();var title=selectedItems.join(", ");if(_this.multiple&&_this.options.selectedTextFormat.indexOf("count")>-1){var max=_this.options.selectedTextFormat.split(">");if(max.length>1&&selectedItems.length>max[1]||max.length==1&&selectedItems.length>=2){title=selectedItems.length+" of "+this.$element.find("option").length+" selected"}}if(!title){title=_this.options.title!=undefined?_this.options.title:_this.options.noneSelectedText}this.$element.next(".select").find(".filter-option").html(title)},setSelected:function(index,selected){if(selected){this.$newElement.find("li").eq(index).addClass("selected")}else{this.$newElement.find("li").eq(index).removeClass("selected")}},setDisabled:function(index,disabled){if(disabled){this.$newElement.find("li").eq(index).addClass("disabled")}else{this.$newElement.find("li").eq(index).removeClass("disabled")}},checkDisabled:function(){if(this.$element.is(":disabled")){this.button.addClass("disabled");this.button.click(function(e){e.preventDefault()})}},checkTabIndex:function(){if(this.$element.is("[tabindex]")){var tabindex=this.$element.attr("tabindex");this.button.attr("tabindex",tabindex)}},clickListener:function(){var _this=this;$("body").on("touchstart.dropdown",".dropdown-menu",function(e){e.stopPropagation()});this.$newElement.on("click","li a",function(e){var clickedIndex=$(this).parent().index(),$this=$(this).parent(),$select=$this.parents(".select");if(_this.multiple){e.stopPropagation()}e.preventDefault();if($select.prev("select").not(":disabled")&&!$(this).parent().hasClass("disabled")){if(!_this.multiple){$select.prev("select").find("option").removeAttr("selected");$select.prev("select").find("option").eq(clickedIndex).prop("selected",true).attr("selected","selected")}else{var selected=$select.prev("select").find("option").eq(clickedIndex).prop("selected");if(selected){$select.prev("select").find("option").eq(clickedIndex).removeAttr("selected")}else{$select.prev("select").find("option").eq(clickedIndex).prop("selected",true).attr("selected","selected")}}$select.find(".filter-option").html($this.text());$select.find("button").focus();$select.prev("select").trigger("change")}});this.$newElement.on("click","li.disabled a, li dt, li .divider",function(e){e.preventDefault();e.stopPropagation();$select=$(this).parent().parents(".select");$select.find("button").focus()});this.$element.on("change",function(e){_this.render()})},val:function(value){if(value!=undefined){this.$element.val(value);this.$element.trigger("change");return this.$element}else{return this.$element.val()}}};$.fn.selectpicker=function(option,event){var args=arguments;var value;var chain=this.each(function(){var $this=$(this),data=$this.data("selectpicker"),options=typeof option=="object"&&option;if(!data){$this.data("selectpicker",data=new Selectpicker(this,options,event))}else{for(var i in option){data[i]=option[i]}}if(typeof option=="string"){property=option;if(data[property]instanceof Function){[].shift.apply(args);value=data[property].apply(data,args)}else{value=data[property]}}});if(value!=undefined){return value}else{return chain}};$.fn.selectpicker.defaults={style:null,size:"auto",title:null,selectedTextFormat:"values",noneSelectedText:"Nothing selected",width:null,menuStyle:null,toggleSize:null}}(window.jQuery);
!function($){var Checkbox=function(element,options){this.init(element,options)};Checkbox.prototype={constructor:Checkbox,init:function(element,options){var $el=this.$element=$(element);this.options=$.extend({},$.fn.checkbox.defaults,options);$el.before(this.options.template);this.setState()},setState:function(){var $el=this.$element,$parent=$el.closest(".checkbox");$el.prop("disabled")&&$parent.addClass("disabled");$el.prop("checked")&&$parent.addClass("checked")},toggle:function(){var ch="checked",$el=this.$element,$parent=$el.closest(".checkbox"),checked=$el.prop(ch),e=$.Event("toggle");if($el.prop("disabled")==false){$parent.toggleClass(ch)&&checked?$el.removeAttr(ch):$el.attr(ch,true);$el.trigger(e).trigger("change")}},setCheck:function(option){var d="disabled",ch="checked",$el=this.$element,$parent=$el.closest(".checkbox"),checkAction=option=="check"?true:false,e=$.Event(option);$parent[checkAction?"addClass":"removeClass"](ch)&&checkAction?$el.attr(ch,true):$el.removeAttr(ch);$el.trigger(e).trigger("change")}};var old=$.fn.checkbox;$.fn.checkbox=function(option){return this.each(function(){var $this=$(this),data=$this.data("checkbox"),options=$.extend({},$.fn.checkbox.defaults,$this.data(),typeof option=="object"&&option);if(!data)$this.data("checkbox",data=new Checkbox(this,options));if(option=="toggle")data.toggle();if(option=="check"||option=="uncheck")data.setCheck(option);else if(option)data.setState()})};$.fn.checkbox.defaults={template:'<span class="icons"><span class="first-icon fui-checkbox-unchecked"></span><span class="second-icon fui-checkbox-checked"></span></span>'};$.fn.checkbox.noConflict=function(){$.fn.checkbox=old;return this};$(document).on("click.checkbox.data-api","[data-toggle^=checkbox], .checkbox",function(e){var $checkbox=$(e.target);if(e.target.tagName!="A"){e&&e.preventDefault()&&e.stopPropagation();if(!$checkbox.hasClass("checkbox"))$checkbox=$checkbox.closest(".checkbox");$checkbox.find(":checkbox").checkbox("toggle")}});$(window).on("load",function(){$('[data-toggle="checkbox"]').each(function(){var $checkbox=$(this);$checkbox.checkbox()})})}(window.jQuery);
$(document).ready(function(){$(".flatui-calendar-input-start").datepicker({showOtherMonths:true,selectOtherMonths:true,onClose:function(selectedDate){$("#end-date").datepicker("option","minDate",selectedDate);$("#end-date").datepicker("show")}});$(".flatui-calendar-input-end").datepicker({showOtherMonths:true,selectOtherMonths:true,onClose:function(selectedDate){$("#start-date").datepicker("option","maxDate",selectedDate)}});$(".flatui-calendar").datepicker({showOtherMonths:true,selectOtherMonths:true});$(".flatui-calendar").on("click",function(){$("#flatui-calendar-input-container").toggle();$(this).blur()});$("#flatui-calendar-confirm-dates").on("click",function(){$(".flatui-calendar-text").text("Change Dates");$("#flatui-calendar-input-container").hide()});$("#flatui-calendar-cancel-dates").on("click",function(){$("#start-date").val("");$("#end-date").val("");$(".flatui-calendar-text").text("View All Dates");$("#flatui-calendar-input-container").hide()})});
(function($){var delimiter=new Array;var tags_callbacks=new Array;$.fn.doAutosize=function(o){var minWidth=$(this).data("minwidth"),maxWidth=$(this).data("maxwidth"),val="",input=$(this),testSubject=$("#"+$(this).data("tester_id"));if(val===(val=input.val())){return}var escaped=val.replace(/&/g,"&amp;").replace(/\s/g," ").replace(/</g,"&lt;").replace(/>/g,"&gt;");testSubject.html(escaped);var testerWidth=testSubject.width(),newWidth=testerWidth+o.comfortZone>=minWidth?testerWidth+o.comfortZone:minWidth,currentWidth=input.width(),isValidWidthChange=newWidth<currentWidth&&newWidth>=minWidth||newWidth>minWidth&&newWidth<maxWidth;if(isValidWidthChange){input.width(newWidth)}};$.fn.resetAutosize=function(options){var minWidth=$(this).data("minwidth")||options.minInputWidth||$(this).width(),maxWidth=$(this).data("maxwidth")||options.maxInputWidth||$(this).closest(".tagsinput").width()-options.inputPadding,val="",input=$(this),testSubject=$("<tester/>").css({position:"absolute",top:-9999,left:-9999,width:"auto",fontSize:input.css("fontSize"),fontFamily:input.css("fontFamily"),fontWeight:input.css("fontWeight"),letterSpacing:input.css("letterSpacing"),whiteSpace:"nowrap"}),testerId=$(this).attr("id")+"_autosize_tester";if(!$("#"+testerId).length>0){testSubject.attr("id",testerId);testSubject.appendTo("body")}input.data("minwidth",minWidth);input.data("maxwidth",maxWidth);input.data("tester_id",testerId);input.css("width",minWidth)};$.fn.addTag=function(value,options){options=jQuery.extend({focus:false,callback:true},options);this.each(function(){var id=$(this).attr("id");var tagslist=$(this).val().split(delimiter[id]);if(tagslist[0]==""){tagslist=new Array}value=jQuery.trim(value);if(options.unique){var skipTag=$(this).tagExist(value);if(skipTag==true){$("#"+id+"_tag").addClass("not_valid")}}else{var skipTag=false}if(value!=""&&skipTag!=true){$("<span>").addClass("tag").append($("<span>").text(value).append("&nbsp;&nbsp;"),$('<a class="tagsinput-remove-link">',{href:"#",title:"Remove tag",text:""}).click(function(){return $("#"+id).removeTag(escape(value))})).insertBefore("#"+id+"_addTag");tagslist.push(value);$("#"+id+"_tag").val("");if(options.focus){$("#"+id+"_tag").focus()}else{$("#"+id+"_tag").blur()}$.fn.tagsInput.updateTagsField(this,tagslist);if(options.callback&&tags_callbacks[id]&&tags_callbacks[id]["onAddTag"]){var f=tags_callbacks[id]["onAddTag"];f.call(this,value)}if(tags_callbacks[id]&&tags_callbacks[id]["onChange"]){var i=tagslist.length;var f=tags_callbacks[id]["onChange"];f.call(this,$(this),tagslist[i-1])}}});return false};$.fn.removeTag=function(value){value=unescape(value);this.each(function(){var id=$(this).attr("id");var old=$(this).val().split(delimiter[id]);$("#"+id+"_tagsinput .tag").remove();str="";for(i=0;i<old.length;i++){if(old[i]!=value){str=str+delimiter[id]+old[i]}}$.fn.tagsInput.importTags(this,str);if(tags_callbacks[id]&&tags_callbacks[id]["onRemoveTag"]){var f=tags_callbacks[id]["onRemoveTag"];f.call(this,value)}});return false};$.fn.tagExist=function(val){var id=$(this).attr("id");var tagslist=$(this).val().split(delimiter[id]);return jQuery.inArray(val,tagslist)>=0};$.fn.importTags=function(str){id=$(this).attr("id");$("#"+id+"_tagsinput .tag").remove();$.fn.tagsInput.importTags(this,str)};$.fn.tagsInput=function(options){var settings=jQuery.extend({interactive:true,defaultText:"",minChars:0,width:"",height:"",autocomplete:{selectFirst:false},hide:true,delimiter:",",unique:true,removeWithBackspace:true,placeholderColor:"#666666",autosize:true,comfortZone:20,inputPadding:6*2},options);this.each(function(){if(settings.hide){$(this).hide()}var id=$(this).attr("id");if(!id||delimiter[$(this).attr("id")]){id=$(this).attr("id","tags"+(new Date).getTime()).attr("id")}var data=jQuery.extend({pid:id,real_input:"#"+id,holder:"#"+id+"_tagsinput",input_wrapper:"#"+id+"_addTag",fake_input:"#"+id+"_tag"},settings);delimiter[id]=data.delimiter;if(settings.onAddTag||settings.onRemoveTag||settings.onChange){tags_callbacks[id]=new Array;tags_callbacks[id]["onAddTag"]=settings.onAddTag;tags_callbacks[id]["onRemoveTag"]=settings.onRemoveTag;tags_callbacks[id]["onChange"]=settings.onChange}var containerClass=$("#"+id).attr("class").replace("tagsinput","");var markup='<div id="'+id+'_tagsinput" class="tagsinput '+containerClass+'"><div class="tagsinput-add-container" id="'+id+'_addTag"><div class="tagsinput-add"></div>';if(settings.interactive){markup=markup+'<input id="'+id+'_tag" value="" data-default="'+settings.defaultText+'" />'}markup=markup+"</div></div>";$(markup).insertAfter(this);$(data.holder).css("width",settings.width);$(data.holder).css("min-height",settings.height);$(data.holder).css("height","100%");if($(data.real_input).val()!=""){$.fn.tagsInput.importTags($(data.real_input),$(data.real_input).val())}if(settings.interactive){$(data.fake_input).val($(data.fake_input).attr("data-default"));$(data.fake_input).css("color",settings.placeholderColor);$(data.fake_input).resetAutosize(settings);$(data.holder).bind("click",data,function(event){$(event.data.fake_input).focus()});$(data.fake_input).bind("focus",data,function(event){if($(event.data.fake_input).val()==$(event.data.fake_input).attr("data-default")){$(event.data.fake_input).val("")}$(event.data.fake_input).css("color","#000000")});if(settings.autocomplete_url!=undefined){autocomplete_options={source:settings.autocomplete_url};for(attrname in settings.autocomplete){autocomplete_options[attrname]=settings.autocomplete[attrname]}if(jQuery.Autocompleter!==undefined){$(data.fake_input).autocomplete(settings.autocomplete_url,settings.autocomplete);$(data.fake_input).bind("result",data,function(event,data,formatted){if(data){$("#"+id).addTag(data[0]+"",{focus:true,unique:settings.unique})}})}else if(jQuery.ui.autocomplete!==undefined){$(data.fake_input).autocomplete(autocomplete_options);$(data.fake_input).bind("autocompleteselect",data,function(event,ui){$(event.data.real_input).addTag(ui.item.value,{focus:true,unique:settings.unique});return false})}}else{$(data.fake_input).bind("blur",data,function(event){var d=$(this).attr("data-default");if($(event.data.fake_input).val()!=""&&$(event.data.fake_input).val()!=d){if(event.data.minChars<=$(event.data.fake_input).val().length&&(!event.data.maxChars||event.data.maxChars>=$(event.data.fake_input).val().length))$(event.data.real_input).addTag($(event.data.fake_input).val(),{focus:true,unique:settings.unique})}else{$(event.data.fake_input).val($(event.data.fake_input).attr("data-default"));$(event.data.fake_input).css("color",settings.placeholderColor)}return false})}$(data.fake_input).bind("keypress",data,function(event){if(event.which==event.data.delimiter.charCodeAt(0)||event.which==13){event.preventDefault();if(event.data.minChars<=$(event.data.fake_input).val().length&&(!event.data.maxChars||event.data.maxChars>=$(event.data.fake_input).val().length))$(event.data.real_input).addTag($(event.data.fake_input).val(),{focus:true,unique:settings.unique});$(event.data.fake_input).resetAutosize(settings);return false}else if(event.data.autosize){$(event.data.fake_input).doAutosize(settings)}});data.removeWithBackspace&&$(data.fake_input).bind("keydown",function(event){if(event.keyCode==8&&$(this).val()==""){event.preventDefault();var last_tag=$(this).closest(".tagsinput").find(".tag:last").text();var id=$(this).attr("id").replace(/_tag$/,"");last_tag=last_tag.replace(/[\s\u00a0]+x$/,"");$("#"+id).removeTag(escape(last_tag));$(this).trigger("focus")}});$(data.fake_input).blur();if(data.unique){$(data.fake_input).keydown(function(event){if(event.keyCode==8||String.fromCharCode(event.which).match(/\w+|[áéíóúÁÉÍÓÚñÑ,/]+/)){$(this).removeClass("not_valid")}})}}});return this};$.fn.tagsInput.updateTagsField=function(obj,tagslist){var id=$(obj).attr("id");$(obj).val(tagslist.join(delimiter[id]))};$.fn.tagsInput.importTags=function(obj,val){$(obj).val("");var id=$(obj).attr("id");var tags=val.split(delimiter[id]);for(i=0;i<tags.length;i++){$(obj).addTag(tags[i],{focus:false,callback:false})}if(tags_callbacks[id]&&tags_callbacks[id]["onChange"]){var f=tags_callbacks[id]["onChange"];f.call(obj,obj,tags[i])}}})(jQuery);
function getPublicMediaUrl(){var abbrHostname=getAbbrHostname();switch(abbrHostname){case"dev":case"localhost":default:return"http://d10nuh33ml191h.cloudfront.net/";break}}function getAbbrHostname(){switch(window.location.hostname){case"pipestack.com":return"prod";case"dev.pipestack.com":return"dev";case"localhost":case"127.0.0.1":return"localhost";break;default:return"";break}}
var filepickerKey="AMPdbi1aZQuuzMBLLznNWz";function convertInkToMediaParams(ink,siteId,nodeId){mediaParams={};mediaParams.filename=ink.key;mediaParams.storage="S3";mediaParams.url=ink.url;mediaParams.mime=ink.mimetype;mediaParams.size=ink.size;mediaParams.siteId=siteId;if(nodeId){mediaParams.nodeId=nodeId}return mediaParams}
var mediaReadAllPath=document.getElementById("media-read-all-path").value;var mediaSavePath=document.getElementById("media-save-path").value;var siteId=document.getElementById("site-id").value;var nodeId=document.getElementById("node-id").value;$(document).ready(function(){loadMediaData(getMediaModalParams())});$(".media-modal-opener").on("click",function(){showMediaModal()});$(".media-modal-filter").on("click",function(){loadMediaData(getMediaModalParams())});$("#form-media-modal-filter").on("submit",function(event){event.preventDefault();loadMediaData(getMediaModalParams())});$(".media-modal-pag-next").on("click",function(){var params=getMediaModalParams();params.page++;loadMediaData(params)});$(".media-modal-pag-previous").on("click",function(){var params=getMediaModalParams();params.page--;loadMediaData(params)});$(".insert-media").on("click",function(){var editor=$(this).attr("data-editor");var selectedMedia=getSelected();var title=selectedMedia.title?selectedMedia.title:"";var alt=selectedMedia.alt?selectedMedia.alt:"";var html='<img src="'+selectedMedia.url+'" alt="'+alt+'" title="'+title+'"/>';if(editor==="tinyMCE"){var mce=tinyMCE.activeEditor;mce.selection.setContent(html)}$("#media-modal-container").modal("hide")});function showMediaModal(){$("#media-modal-container").modal("show");loadMediaData(getMediaModalParams());return 1}function getMediaModalParams(){var search=document.getElementById("media-modal-input-search").value;var type=document.getElementById("media-modal-input-type").value;var page=document.getElementById("media-modal-input-page").value;var mediaModalParams={};mediaModalParams.limit=18;if(search){mediaModalParams.search=search}if(type){mediaModalParams.type=type}if(!page){page=1}mediaModalParams.page=page;return mediaModalParams}function getMediaReadAllPath(format){if(!format){return mediaReadAllPath}else if(format==="json"){return mediaReadAllPath+"?format=json"}}$(".media-load-upload").on("click",function(event){event.preventDefault();loadUploader()});$(".media-load-library").on("click",function(event){event.preventDefault();loadMediaData(getMediaModalParams())});function loadUploader(){$(".media-load-upload").css("color","#95A5A6");$(".media-load-library").css("color","#16A085");$("#media-library-container").hide();$("#media-uploader-container").show();uploadInline("media-upload-iframe")}function uploadInline(iframeId){filepicker.pickAndStore({container:iframeId},{location:"S3",access:"public"},function(InkBlobs){var mediaParams=convertInkToMediaParams(InkBlobs[0],siteId,nodeId?nodeId:null);mediaParams.url=getPublicMediaUrl()+mediaParams.filename;$.post(mediaAddPath,mediaParams,function(data,textStatus,xhr){if(textStatus=="success"){var title=mediaParams.title?mediaParams.title:"";var alt=mediaParams.alt?mediaParams.alt:"";var html='<img src="'+mediaParams.url+'" alt="'+alt+'" title="'+title+'"/>';var mce=tinyMCE.activeEditor;mce.selection.setContent(html);$("#media-modal-container").modal("hide")}else{alert("Upload failed. Please try again")}})})}function loadMediaData(params){$("#primary-media-data-container").html("");$.get(getMediaReadAllPath("json"),params,function(data,textStatus,xhr){if(textStatus==="success"){showHideMediaModalPag(data.length,params.limit,params.page);$(".media-load-upload").css("color","#16A085");$(".media-load-library").css("color","#95A5A6");$("#media-uploader-container").hide();$("#media-library-container").show();var mediaLoader=document.getElementById("media-modal-loader");var primaryMediaDataContainer=document.getElementById("primary-media-data-container");var mediaHTML="";mediaLoader.className+=" hide";for(var i=0;i<data.length;i++){mediaHTML=document.createElement("div");mediaHTML.innerHTML="<img src='"+data[i].url+"' class='span2 media-preview' style='padding: 10px' data-media-json='"+JSON.stringify(data[i])+"'/>";primaryMediaDataContainer.appendChild(mediaHTML)}$(".media-preview").on("click",function(){var mediaDataJSON=$(this).attr("data-media-json");var mediaData=$.parseJSON(mediaDataJSON);selectMedia($(this));displayEditor(mediaData)});return 1}else{alert("We are not able to load your media at this time. Please be sure you are logged in and try again.");return 0}})}function showHideMediaModalPag(count,limit,page){if(count<limit){$(".media-modal-pag-next").addClass("disabled")}else{$(".media-modal-pag-next").removeClass("disabled")}if(page<2){$(".media-modal-pag-previous").addClass("disabled")}else{$(".media-modal-pag-previous").removeClass("disabled")}}function displayEditor(media){var editor=document.getElementById("primary-media-editor");var html='<div class="span12">';if(media.metadata.title){html+="<h4> Edit "+media.metadata.title+"</h4>";var title=media.metadata.title}else{html+="<h4>Edit Media</h4>";var title=""}if(media.metadata.alt){var alt=media.metadata.alt}else{var alt=""}html+='</div></div><div class="row-fluid"><div class="span12" style="margin-bottom: 10px;"><img src="'+media.url+'"/></div></div>';html+='<div class="row-fluid"><div class="span12"><form id="edit-media-form"><input type="text" id="input-media-edit-title" class="span12" style="margin: 10px 0px; font-size: 12px;" value="'+title+'" placeholder="title"/><input type="text" id="input-media-edit-alt" class="span12" style="margin: 10px 0px; font-size: 12px;" value="'+alt+'" placeholder="alt"/><button class="btn btn-info btn-block media-edit-save">Save</button></form></div></div>';editor.innerHTML=html;$("#input-media-edit-title").focus();$("#edit-media-form").on("submit",function(event){event.preventDefault();var newMedia=getNewMediaParams(media);$(".media-edit-save").text("saving...");$.post(mediaSavePath,newMedia,function(data,textStatus,xhr){if(textStatus==="success"){$(".media-edit-save").text("Save")}else{alert("Unable to edit media at this time. Please try again");$(".media-edit-save").text("Save")}})});return 1}function getNewMediaParams(media){objParams={};objParams.id=media.id;if(!media.metadata){media.metadata={}}media.metadata.title=document.getElementById("input-media-edit-title").value;media.metadata.alt=document.getElementById("input-media-edit-title").value;objParams.metadata=JSON.stringify(media.metadata);return objParams}function selectMedia($media){$(".media-preview").removeClass("media-selected");$media.addClass("media-selected");return 1}function getSelected(){var $selected=$("#primary-media-data-container").find(".media-selected:first");var json=$selected.attr("data-media-json");console.log(json);return 0;return $.parseJSON(json)}
var savePath=document.getElementById("save-path").value;var editPath=document.getElementById("edit-path").value;var deletePath=document.getElementById("delete-path").value;var readContentTypePath=document.getElementById("read-content-type-path").value;var baseUrl=document.getElementById("base-url").value;var mediaAddPath=document.getElementById("media-add-path").value;$(document).ready(function(){$("select").selectpicker();$(".select .dropdown-toggle").addClass("btn-info");$(".dropdown-menu").addClass("dropdown-inverse");$(".dropdown-arrow").addClass("dropdown-arrow-inverse");$("#tags").tagsInput();var alertOn=$(".alert").length>0;if(alertOn){$("#inner-notice-container").show(0).delay(1e3).fadeOut(1e3)}tinyMCE.init({plugins:"link, table, save, fullscreen, charmap, code, paste, media, contextmenu",save_enablewhendirty:true,save_onsavecallback:function(){saveAJAX(getParams())},skin:"flat",visual:false,statusbar:true,menubar:"view, edit, insert, format, table",toolbar:"undo, redo | bold, italic, strikethrough | alignleft, aligncenter, alignright, justify | bullist, numlist  outdent, indent |  code | charmap, link, image, cms-media",schema:"html5",selector:"#view-html",image_advtab:false,setup:function(editor){editor.addButton("cms-media",{title:"Media",type:"button",icon:"image",style:"float: right;",onclick:function(){showMediaModal()}})}});filepicker.setKey(filepickerKey)});$(".upload-media").on("click",function(event){event.preventDefault();if($(this).hasClass("upload-featured")){upload("featured")}else{upload("standard")}});function insertMedia(html){var editor=tinyMCE.activeEditor;editor.selection.setContent(html)}function upload(type){filepicker.pickAndStore({},{location:"S3",access:"public"},function(InkBlobs){var params=getParams();var mediaParams=convertInkToMediaParams(InkBlobs[0],params.siteId,params.id);mediaParams.url=getPublicMediaUrl()+mediaParams.filename;$.post(mediaAddPath,mediaParams,function(data,textStatus,xhr){if(textStatus=="success"){if(type=="featured"){$(".featured-image-container").html('<img src="'+mediaParams.url+'" class="span12" id="input-featured-image">')}else{alert("added"+mediaParams.url)}if(params.id){saveAJAX(getParams())}}else{alert("Upload failed. Please try again")}})})}$("#state-container-opener").on("click",function(){$("#state-container").toggle()});$("#publish-date-container-opener").on("click",function(){$("#publish-date-container").toggle()});$("#input-state").on("change",function(){$("#submit-input-state").show()});$("#submit-input-state").on("click",function(){save(getParams())});$("#add-category-opener").on("click",function(){$("#add-category-container").toggle()});$("#cancel-add-category").on("click",function(){clearAddCategory()});$(".edit-fields").on("click",function(event){event.preventDefault()});$(".field-key-value-pairs-container-toggler").on("click",function(event){event.preventDefault();$(".field-key-value-pairs-container").show();$(this).hide();toggleAddField()});$(".add-field-toggler").on("click",function(event){event.preventDefault();toggleAddField()});$(".edit-fields").on("click",function(event){event.preventDefault();if($(this).hasClass("btn-inverse")){$(this).removeClass("btn-inverse").addClass("btn-primary").html('<i class="icon-save"> Done</i>');$(".add-field-toggler").hide();$("#add-field-footer-btn-container .save-node").hide();$(".field-key-input").attr("type","text").parent("div").removeClass("span4").addClass("span10");$(".field-key").hide();$(".field-value").hide();$(".field-key-value-pairs").append('<button class="btn btn-danger remove-field" style="position: relative; left: 10px;"><i class="icon-trash"> Delete</i></button>');$(".remove-field").on("click",function(event){event.preventDefault();if(confirm("Are you sure you want to remove this field?")){var $container=$(this).parent("div");var field={key:$container.attr("data-field-key"),value:$container.attr("data-field-value")};$container.remove()}})}else{$(this).removeClass("btn-primary").addClass("btn-inverse").html('<i class="icon-edit"></i> Edit');$(".add-field-toggler").show();$("#add-field-footer-btn-container .save-node").show();$(".field-key-input").attr("type","hidden").parent("div").removeClass("span10").addClass("span4");$(".field-key").show();$(".field-value").show();$(".remove-field").remove()}});$(".field-key-input").on("blur",function(){$(this).next().text($(this).val())});$(".create-field-key").on("click",function(event){event.preventDefault();var key=document.getElementById("input-new-field-key");var field=createNewField(key.value);$(".field-key-value-pairs-inner").append(field);key.value="";$(".add-field").hide()});$(".confirm-add-category").on("click",function(){addCategory()});$("#add-category-form").on("submit",function(event){event.preventDefault();addCategory()});$(".category-toggle-icon").on("click",function(){var parentStr=$(this).attr("data-parent");switchCategorySub(parentStr);switchToggleIcon($(this))});$(".category-parent-name").on("click",function(){var $td=$(this).next();switchCategorySub($td.attr("data-parent"));switchToggleIcon($td)});$(".save-node").on("click",function(){saveAJAX(getParams())});$(".preview-node").on("click",function(){var params=getParams();save(params)});$(".delete-node").on("click",function(){if(confirm("Are you sure you want to permanently delete this item?")){var token=document.getElementById("input-token").value;var id=document.getElementById("input-id").value;$.post(deletePath,{id:id,token:token},function(data,textStatus,xhr){if(textStatus==="success"){window.location.href=readContentTypePath}else{alert("Unable to delete. Please try again.")}})}});$(".publish-node").on("click",function(){params=getParams();params.state="active";save(params)});$(".category-toggle-icon").on("click",function(){var parentStr=$(this).attr("data-parent").toLowerCase();var dataContainer=$(".category-data tr[data-parent='"+parentStr+"']");var data="";var results=$("#table-category-clone tr[data-parent='"+parentStr+"']").html();dataContainer.html(data)});function switchCategorySub(parentStr){$(".parent-"+parentStr).toggle()}function switchToggleIcon($td){var state=$td.attr("data-state");if(state==="opened"){$td.html('<i class="icon-chevron-sign-left"></i>');$td.attr("data-state","closed")}else{$td.html('<i class="icon-chevron-sign-down"></i>');$td.attr("data-state","opened")}}function clearAddCategory(){$("#add-category-parent").val("");$("#add-category-sub").val("");$("#add-category-container").hide()}function getFullSlug(params){var slug=params.slug;var slugprefix=params.slugPrefix;if(slug.indexOf(slugprefix)!==-1){return params.slug}else{return params.slugPrefix+params.slug}}function getUrl(params){return"/"+getFullSlug(params)}function getParams(){objParams={};objParams["token"]=document.getElementById("input-token").value;objParams["id"]=document.getElementById("input-id").value;objParams["state"]=document.getElementById("input-state").value;objParams["siteId"]=document.getElementById("input-site-id").value;objParams["contentTypeName"]=document.getElementById("input-content-type-name").value;objParams["format"]=document.getElementById("input-format").value;objParams["templateName"]=document.getElementById("input-template-name").value;objParams["slugPrefix"]=document.getElementById("input-slug-prefix").value;objParams["domain"]=document.getElementById("domain").value;objParams["slug"]=document.getElementById("slug").value;objParams["title"]=document.getElementById("title").value;objParams["description"]=document.getElementById("input-description").value;objParams["viewHtml"]=tinyMCE.activeEditor.getContent();objParams["viewText"]=tinyMCE.activeEditor.getContent({format:"raw"});objParams["description"]=document.getElementById("input-description").value;objParams["authorId"]=document.getElementById("input-author-id").value;objParams["authorFirstName"]=document.getElementById("input-author-first-name").value;objParams["authorLastName"]=document.getElementById("input-author-last-name").value;objParams["authorImage"]=document.getElementById("input-author-image").value;objParams["featuredImage"]=$("#input-featured-image").attr("src");objParams["categoriesJSON"]=JSON.stringify(getCategories());objParams["tagsJSON"]=JSON.stringify(getTags());objParams["fieldsJSON"]=JSON.stringify(getFields());console.log(objParams["fieldsJSON"]);return objParams}function getCategories(){var categories=[];var result={};$("#categories-holder .checked").each(function(){var categoryArray=$(this).attr("data-category").split("-");if(categoryArray.length>1){result={parent:categoryArray[0],sub:categoryArray[1]}}else{result={parent:categoryArray[0]}}categories.push(result)});return categories}function getRawCategories(){var categories=[];$("#categories-holder .checked").each(function(){categories.push($(this).attr("data-category"))});return categories}function addCategory(){var path=document.getElementById("add-category-path").value;params=getParams();catParams={};catParams.siteId=params.siteId;catParams.id=document.getElementById("input-content-type-id").value;catParams.parent=document.getElementById("add-category-parent").value;catParams.sub=document.getElementById("add-category-sub").value;$.post(path,catParams,function(data,textStatus,xhr){if(textStatus==="success"){save(params,"#categories-holder")}else{alert("Unable to add new category. Please try again.")}})}function getTags(){return document.getElementById("tags").value.split(",")}function createNewField(key){return'<div class="row-fluid field-key-value-pairs"><div class="span4"><input type="hidden" class="field-key-input" value="'+key+'"/><span class="field-key">'+key+'</span></div><div class="span8"><input type="text" class="span12 field-value" placeholder="add a value for '+key+'"/></div></div>'}function getFields(){var fields=[];var obj={};$(".field-key-value-pairs").each(function(){obj.key=$(this).find(".field-key").text();obj.value=$(this).find(".field-value").val();fields.push(obj);obj={}});return fields}function toggleAddField(){var $addField=$(".add-field");$addField.toggle();$("#input-new-field-key").focus()}function saveAJAX(params){$.post(savePath,params,function(data,textStatus,xhr){if(textStatus==="success"){if(!params.id){window.location.href=editPath+"/"+data+"?siteId="+siteId}$("#notice-container").html('<div class="alert alert-info"><button type="button" class="close" data-dismiss="alert" style="color: white">&times;</button><i class="icon-bullhorn" style="margin-right: 5px;"></i> Save Complete</div>')}else{alert("Unable to save. Please be sure you are logged in and try again. If problem persists please contact customer services.");return 0}})}function save(params,urlAffix){if(!urlAffix){urlAffix=""}$.post(savePath,params,function(data,textStatus,xhr){if(textStatus==="success"){window.location.href=savePath+"/"+data+urlAffix}else{alert("Unable to save. Please be sure you are logged in and try again. If problem persists please contact customer services.")}})}function saveAndPreview(params){if(!params.slug){alert("You must include a title before seeing a preview");return 0}var url=getUrl(params);$.post(savePath,params,function(data,textStatus,xhr){if(textStatus==="success"){window.location.href=savePath+"/"+data;window.open(url,"_blank")}else{alert("Unable to display preview. Please try again.");return 0}})}
var oldTitle=document.getElementById("title").value;$("#domain-container").on("click",function(){$("#slug-selector-container").hide();$("#domain-selector-container").toggle()});$(".radio-domain").click(function(){var domain=$(this).find("input").attr("data-domain");updateDomain(domain);$("#domain-selector-container").hide(400)});$(".radio-slug").on("click",function(){var slugType=$(this).attr("data-slug-type");var $title=$("#title");if(slugType==="title"){$title.attr("data-slug-title","on");var text=$title.val();$("#slug-selector-container").hide()}else{$title.attr("data-slug-title","off");$("#input-custom-slug-container").show();$("#button-custom-slug").show();var text=$("#input-custom-slug").val()}updateSlug(text)});$("#slug-container").on("click",function(){$("#domain-selector-container").hide();$("#slug-selector-container").toggle()});$("#title").blur(function(){if($(this).attr("data-slug-title")==="on"&&document.getElementById("title").value!=oldTitle){if(document.getElementById("state").value=="active"){oldTitle=$(this).val();if(!confirm("Would you like to update the url to match this new title?")){return 0}}updateSlug($(this).val())}});$("#input-custom-slug").blur(function(){var text=$(this).val();updateSlug(text);$("#slug-selector-container").hide()});function updateSlug(text){text=text.replace(/\s+/g,"-").toLowerCase();$("#slug-container").text(text);$("#slug").val(text)}function updateDomain(domain){$("#domain-container").text(domain);$("#domain").val(domain)}